{"version":3,"sources":["webpack:///webpack/bootstrap c170c4c28701a1725bed","webpack:///./boot/electron.ts","webpack:///external \"electron\"","webpack:///./modules/FileStorage/helper/FileStorageMain.ts","webpack:///./modules/Graph/helper/GraphParser.ts","webpack:///./modules/Graph/types/index.ts","webpack:///./modules/Graph/types/NodeType.ts","webpack:///external \"fs\"","webpack:///external \"path\"","webpack:///./~/sanitize-filename/index.js","webpack:///./~/truncate-utf8-bytes/index.js","webpack:///./~/truncate-utf8-bytes/lib/truncate.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;AClCA,OAAM,EAAE,GAAG,EAAE,aAAa,EAAE,GAAG,mBAAO,CAAG,CAAU,CAAE;AACrD,+CAA8C,CAI9C,CAAC,CAJ4F;AAE7F,+EAA8E;AAC9E,4EAA2E;AAC3E,KAAI,GAAG;AAEP;KACE,6BAA6B;KAC7B,GAAG,GAAG,IAAI,aAAa,CAAC,EAAC,KAAK,EAAE,GAAG,EAAE,MAAM,EAAE,GAAG,EAAC,CAAC;KAElD,+CAA+C;KAC/C,GAAG,CAAC,OAAO,CAAC,UAAU,SAAS,uBAAuB,CAAC;KAEvD,qBAAqB;KACrB,GAAG,CAAC,WAAW,CAAC,YAAY,EAAE;KAE9B,qCAAqC;KACrC,GAAG,CAAC,EAAE,CAAC,QAAQ,EAAE;SACf,iEAAiE;SACjE,mEAAmE;SACnE,oDAAoD;SACpD,GAAG,GAAG,IAAI;KACZ,CAAC,CAAC;KAEF,uBAAoB,EAAG;AACzB,EAAC;AAED,yDAAwD;AACxD,0DAAyD;AACzD,uDAAsD;AACtD,IAAG,CAAC,EAAE,CAAE,OAAO,EAAE,YAAY,CAAE;AAE/B,qCAAoC;AACpC,IAAG,CAAC,EAAE,CAAC,mBAAmB,EAAE;KAC1B,4DAA4D;KAC5D,8DAA8D;KAC9D,EAAE,CAAC,CAAC,OAAO,CAAC,QAAQ,KAAK,QAAQ,CAAC,CAAC,CAAC;SAClC,GAAG,CAAC,IAAI,EAAE;KACZ,CAAC;AACH,EAAC,CAAC;AAEF,IAAG,CAAC,EAAE,CAAC,UAAU,EAAE;KACjB,iEAAiE;KACjE,4DAA4D;KAC5D,EAAE,CAAC,CAAC,GAAG,KAAK,IAAI,CAAC,CAAC,CAAC;SACjB,YAAY,EAAE;KAChB,CAAC;AACH,EAAC,CAAC;;;;;;;ACpDF,sC;;;;;;;ACIA,2CAA0B,CAE1B,CAAC,CAFyD;AAG1D,OAAM,EAAE,OAAO,EAAE,MAAM,EAAE,GAAG,mBAAO,CAAG,CAAU,CAAE;AAClD,OAAM,EAAE,GAAG,mBAAO,CAAG,CAAI,CAAE;AAC3B,OAAM,IAAI,GAAG,mBAAO,CAAG,CAAM,CAAE;AAC/B,OAAM,QAAQ,GAAG,mBAAO,CAAG,CAAmB,CAAE;AAehD,OAAM,cAAc,GAAgB,EAAE;AACtC,KAAI,SAAoB;AACxB,KAAI,UAAqB;AAEzB,wCAAuC;AACvC,OAAM,YAAY,GAAG,EAAE,IAAI,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE;AAE3C,2CAA0C;AAC1C,+EAA8E;AAC9E,KAAI,WAAW,GAAG,qCAAqC;AACvD,KAAI,WAAW,GAAG,gDAAgD;AAErD,cAAK,GAAG;KAEnB,OAAO,CAAC,EAAE,CAAG,gBAAgB,EAAE;SAC7B,OAAO;SACP,6BAA6B;SAC7B,sCAAsC;SACtC,+BAA+B;KACjC,CAAC,CAAC;KAEF,OAAO,CAAC,EAAE,CAAG,kBAAkB,EAAE;SAC/B,OAAO;SACP,kDAAkD;SAClD,2DAA2D;SAC3D,+BAA+B;KACjC,CAAC,CAAC;KAEF,OAAO,CAAC,EAAE,CACR,iBAAiB,EACjB,CAAE,KAAK,EAAE,OAAoB;SAC3B,gBAAgB;SAChB,IAAI,CAAC;aACH,WAAW,CACT,CAAE,WAAW,CAAE,EACf,OAAO,EACP,cAAc,CAAG,OAAO,CAAC,GAAG,CAAE,CAC/B;SACH,CACA;SAAA,KAAK,CAAC,CAAE,GAAI,CAAC,CAAC,CAAC;aACb,KAAK,CAAC,MAAM,CAAC,IAAI,CAAG,OAAO,EAAE,GAAG,CAAC,OAAO,CAAE;SAC5C,CAAC;KACH,CAAC,CACF;KAED,OAAO,CAAC,EAAE,CACR,eAAe,EACf,CAAE,KAAK,EAAE,KAAgB;SACvB,SAAS;SACT,IAAI,CAAC;aACH,WAAW,CACT,CAAE,WAAW,EAAE,QAAQ,CAAE,EACzB,KAAK,EACL,cAAc,CAAG,KAAK,CAAC,GAAG,CAAE,CAC7B;SACH,CACA;SAAA,KAAK,CAAC,CAAE,GAAI,CAAC,CAAC,CAAC;aACb,KAAK,CAAC,MAAM,CAAC,IAAI,CAAG,OAAO,EAAE,GAAG,CAAC,OAAO,CAAE;SAC5C,CAAC;KACH,CAAC,CACF;KAED,OAAO,CAAC,EAAE,CAAG,gBAAgB,EAAE,CAAE,KAAK,EAAE,SAAS;SAC/C,4BAA4B;KAC9B,CAAC,CAAC;KAEF;;;;OAIE;AACJ,EAAC;AAED,OAAM,IAAI,GACV,CAAE,IAAY;KACZ,IAAI,CAAC;SACH,MAAM,CAAC,EAAE,CAAC,QAAQ,CAAG,IAAI,CAAE;KAC7B,CACA;KAAA,KAAK,CAAC,CAAE,GAAI,CAAC,CAAC,CAAC;SACb,MAAM,CAAC,IAAI;KACb,CAAC;AACH,EAAC;AAED,OAAM,WAAW,GACjB,CAAE,KAAe,EACf,KAA8B,EAC9B,KAAiB;KAEjB,eAAe;KACf,UAAU,GAAG,EAAE;KACf,IAAI,QAAQ,GAAG,KAAK,CAAG,CAAC,CAAE;KAC1B,GAAG,CAAC,CAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,EAAE,CAAC,EAAG,CAAC;SACxC,QAAQ,GAAG,UAAU,CAAG,QAAQ,EAAE,KAAK,CAAG,CAAC,CAAE,CAAE;KACjD,CAAC;KAED,EAAE,CAAC,CAAE,CAAC,KAAM,CAAC,CAAC,CAAC;SACb,MAAM,KAAK,GAAe,EAAE,KAAK,EAAE,KAAK,EAAE,EAAE,EAAE;SAC9C,SAAS,GAAG,KAAK,CAAC,KAAK;SACvB,UAAU,GAAG,KAAK,CAAC,KAAK;SACxB,WAAW,CAAG,QAAQ,EAAE,KAAK,CAAE;SAC/B,cAAc,CAAG,KAAK,CAAC,GAAG,CAAE,GAAG,KAAK;KACtC,CAAC;KACD,IAAI,CAAC,CAAC;SACJ,MAAM,MAAM,GAAG,KAAK,CAAC,KAAK;SAC1B,EAAE,CAAC,CAAE,MAAM,CAAC,IAAI,KAAK,KAAK,CAAC,IAAK,CAAC,CAAC,CAAC;aACjC,sBAAsB;aACtB,MAAM,IAAI,GAAG,IAAI,CAAC,OAAO,CAAG,QAAQ,EAAE,QAAQ,CAAG,MAAM,CAAC,IAAI,CAAE,CAAE;aAChE,MAAM,EAAE,GAAG,IAAI,CAAC,OAAO,CAAG,QAAQ,EAAE,QAAQ,CAAG,KAAK,CAAC,IAAI,CAAE,CAAE;aAC7D,MAAM,KAAK,GAAG,IAAI,CAAG,IAAI,CAAE;aAC3B,MAAM,GAAG,GAAG,IAAI,CAAG,EAAE,CAAE;aACvB,EAAE,CAAC,CAAE,KAAK,IAAI,KAAK,CAAC,WAAW,EAAG,IAAI,CAAC,GAAI,CAAC,CAAC,CAAC;iBAC5C,OAAO;iBACP,EAAE,CAAC,UAAU,CAAG,IAAI,EAAE,EAAE,CAAE;iBAC1B,OAAO,CAAC,GAAG,CAAG,WAAW,GAAG,IAAI,GAAG,OAAO,GAAG,EAAE,CAAE;iBACjD,eAAe;iBACf,MAAM,QAAQ,GAAG,KAAK,CAAC,KAAK;iBAC5B,MAAM,QAAQ,GAAG,EAAE;iBACnB,MAAM,KAAK,GAAG,IAAI,CAAC,MAAM;iBACzB,GAAG,CAAC,CAAE,MAAM,CAAC,IAAI,QAAS,CAAC,CAAC,CAAC;qBAC3B,MAAM,EAAE,GAAG,IAAI,CAAC,OAAO,CAAG,EAAE,EAAE,CAAC,CAAC,MAAM,CAAG,KAAK,CAAE,CAAE;qBAClD,QAAQ,CAAG,EAAE,CAAE,GAAG,QAAQ,CAAG,CAAC,CAAE;iBAClC,CAAC;iBACD,KAAK,CAAC,KAAK,GAAG,QAAQ;aACxB,CAAC;SACH,CAAC;SAED,SAAS,GAAG,KAAK,CAAC,KAAK;SACvB,UAAU,GAAG,EAAE;SACf,WAAW,CAAG,QAAQ,EAAE,KAAK,CAAE;SAE/B,+BAA+B;SAC/B,sBAAsB;SACtB,MAAM,IAAI,GAAG,MAAM,CAAC,IAAI,CAAG,SAAS,CAAE,CAAC,IAAI,CAAG,CAAE,CAAC,EAAE,CAAC,KAAM,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAE;SAC1E,GAAG,CAAC,CAAE,MAAM,CAAC,IAAI,IAAK,CAAC,CAAC,CAAC;aACvB,EAAE,CAAC,CAAE,CAAE,UAAU,CAAG,CAAC,CAAG,CAAC,CAAC,CAAC;iBACzB,kBAAkB;iBAClB,MAAM,CAAC,GAAG,IAAI,CAAG,CAAC,CAAE;iBACpB,EAAE,CAAC,CAAE,CAAC,CAAE,CAAC,CAAC,CAAC;iBAEX,CAAC;iBAAC,IAAI,CAAC,EAAE,CAAC,CAAE,CAAC,CAAC,MAAM,EAAI,CAAC,CAAC,CAAC;qBACzB,EAAE,CAAC,UAAU,CAAG,CAAC,CAAE;qBACnB,OAAO,CAAC,GAAG,CAAG,WAAW,GAAG,CAAC,CAAE;iBACjC,CAAC;iBAAC,IAAI,CAAC,EAAE,CAAC,CAAE,CAAC,CAAC,WAAW,EAAI,CAAC,CAAC,CAAC;qBAC9B,4CAA4C;qBAC5C,MAAM,KAAK,GAAG,EAAE,CAAC,WAAW,CAAG,CAAC,CAAE;qBAClC,EAAE,CAAC,CAAE,KAAK,CAAC,MAAM,KAAK,CAAE,CAAC,CAAC,CAAC;yBACzB,EAAE,CAAC,SAAS,CAAG,CAAC,CAAE;qBACpB,CAAC;iBACH,CAAC;iBACD,IAAI,CAAC,CAAC;iBAEN,CAAC;aACH,CAAC;SACH,CAAC;SACD,KAAK,CAAC,KAAK,GAAG,KAAK;SACnB,KAAK,CAAC,KAAK,GAAG,UAAU;KAC1B,CAAC;AACH,EAAC;AAED,OAAM,QAAQ,GACd,CAAE,IAAY,EAAE,IAAY,EAAE,MAAc,CAAC,WAAW;KACtD,MAAM,CAAC,GAAG,IAAI,CAAC,OAAO,CAAG,IAAI,EAAE,QAAQ,CAAG,IAAI,CAAE,CAAE;KAClD,MAAM,CAAC,GAAG,SAAS,CAAG,CAAC,CAAE;KACzB,4EAA4E;KAC5E,EAAE,CAAC,CAAE,CAAC,KAAK,MAAO,CAAC,CAAC,CAAC;SACnB,cAAc;SACd,UAAU,CAAG,CAAC,CAAE,GAAG,MAAM;SACzB,MAAM;KACR,CAAC;KACD,MAAM,CAAC,GAAG,IAAI,CAAG,CAAC,CAAE;KACpB,EAAE,CAAC,CAAE,CAAC,CAAC,IAAI,CAAC,CAAC,MAAM,EAAI,CAAC,CAAC,CAAC;SACxB,eAAe;SACf,EAAE,CAAC,aAAa,CAAG,CAAC,EAAE,MAAM,EAAE,MAAM,CAAE;SACtC,OAAO,CAAC,GAAG,CAAG,WAAW,GAAG,CAAC,CAAE;KACjC,CAAC;KACD,IAAI,CAAC,CAAC;SACJ,aAAa;SACb,MAAM,gCAAgC,CAAC,iBAAiB;KAC1D,CAAC;KACD,UAAU,CAAG,CAAC,CAAE,GAAG,MAAM;AAC3B,EAAC;AAED,OAAM,UAAU,GAChB,CAAE,IAAY,EAAE,IAAY;KAC1B,MAAM,CAAC,GAAG,IAAI,CAAC,OAAO,CAAG,IAAI,EAAE,QAAQ,CAAG,IAAI,CAAE,CAAE;KAClD,MAAM,CAAC,GAAG,IAAI,CAAG,CAAC,CAAE;KACpB,EAAE,CAAC,CAAE,CAAC,CAAE,CAAC,CAAC,CAAC;SACT,EAAE,CAAC,SAAS,CAAG,CAAC,CAAE;SAClB,OAAO,CAAC,GAAG,CAAG,WAAW,GAAG,CAAC,CAAE;KACjC,CAAC;KACD,IAAI,CAAC,EAAE,CAAC,CAAE,CAAC,CAAC,CAAC,WAAW,EAAI,CAAC,CAAC,CAAC;SAC7B,QAAQ;SACR,MAAM,yBAAyB,CAAC,mBAAmB;KACrD,CAAC;KACD,UAAU,CAAG,CAAC,CAAE,GAAG,IAAI;KACvB,MAAM,CAAC,CAAC;AACV,EAAC;AAED,OAAM,WAAW,GACjB,CAAE,QAAgB,EAChB,KAAgB;KAEhB,MAAM,IAAI,GAAG,UAAU,CAAG,QAAQ,EAAE,KAAK,CAAC,IAAI,CAAE;KAChD,uBAAS,CAAG,KAAK,EAAE,IAAI,EAAE,QAAQ,EAAE,UAAU,CAAE;AACjD,EAAC;AAED,OAAM,mBAAmB,GACzB,CAAE,IAAY;KACZ,WAAW,GAAG,IAAI;KAClB,cAAc;KACd,6CAA6C;KAC7C,+BAA+B;AACjC,EAAC;;;;;;;;AC7OD,qCAAsC,CACtC,CAAC,CAD+C;AAWhD,OAAM,SAAS,GACf,CAAE,KAAgB,EAChB,OAAY,EACZ,IAAgB,EAChB,MAAoB,EACpB,MAAc,EACd,OAAgB;KAEhB,MAAM,IAAI,GAAG,KAAK,CAAC,SAAS,CAAG,MAAM,CAAE;KACvC,MAAM,KAAK,GAAG,KAAK,CAAC,UAAU,CAAG,IAAI,CAAC,OAAO,CAAE;KAC/C,MAAM,IAAI,GAAG,OAAO,GAAG,GAAG,OAAO,IAAI,KAAK,CAAC,IAAI,EAAE,GAAG,KAAK,CAAC,IAAI;KAC9D,IAAI,CAAG,OAAO,EAAE,GAAG,IAAI,KAAK,EAAE,KAAK,CAAC,MAAM,CAAE;KAC5C,IAAI,GAAG;KACP,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ;KAC9B,GAAG,CAAC,CAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,EAAE,CAAC,EAAG,CAAC;SAC3C,MAAM,OAAO,GAAG,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,EAAE,GAAG,MAAM,CAAG,CAAC,CAAE;SAC/C,MAAM,OAAO,GAAG,QAAQ,CAAG,CAAC,CAAE;SAC9B,EAAE,CAAC,CAAE,OAAQ,CAAC,CAAC,CAAC;aACd,EAAE,CAAC,CAAE,CAAC,GAAI,CAAC,CAAC,CAAC;iBACX,6BAA6B;iBAC7B,GAAG,GAAG,MAAM,CAAG,OAAO,EAAE,IAAI,CAAE;aAChC,CAAC;aACD,SAAS,CAAG,KAAK,EAAE,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,OAAO,CAAE;SAC1D,CAAC;KACH,CAAC;AACH,EAAC;AAEY,oBAAW,GACxB,CAAE,KAAgB,EAChB,OAAY,CAAC,8CAA8C;OAC3D,IAAgB,EAChB,MAAoB;KAEpB,SAAS,CAAG,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,kBAAU,CAAE;AACxD,EAAC;AAEY,kBAAS,GACtB,CAAE,KAAgB,EAChB,OAAY,EACZ,IAAgB,EAChB,MAAoB;KAEpB,SAAS,CAAG,KAAK,CAAC,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,kBAAU,CAAE;KAC5D,YAAY,CAAG,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,CAAE;AAC/C,EAAC;AAED,OAAM,YAAY,GAClB,CAAE,KAAgB,EAChB,OAAY,EACZ,IAAgB,EAChB,MAAoB;KAEpB,MAAM,GAAG,GAAG,MAAM,CAAC,MAAM,CAAG,EAAE,EAAE,KAAK,CAAE;KACvC,OAAO,GAAG,CAAC,KAAK;KAChB,MAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAG,GAAG,EAAE,IAAI,EAAE,CAAC,CAAE;KAC5C,IAAI,CAAG,OAAO,EAAE,YAAY,EAAE,IAAI,CAAE;AACtC,EAAC;;;;;;;;;;;ACjED,8BAAc,CACd,CAAC,EADyB;;;;;;;;AC2Bb,mBAAU,GACvB,CAAE,SAAuB;KAEvB,IAAI,CAAC,GAAY,CAAC;KAClB,OAAQ,SAAS,CAAG,IAAI,CAAC,EAAE,CAAE,EAAG,CAAC;SAC/B,CAAC,IAAI,CAAC;KACR,CAAC;KACD,MAAM,CAAC,IAAI,CAAC,EAAE;AAChB,EAAC;AAEY,mBAAU,GAAG,kBAAU,CAAG,EAAE,CAAE;;;;;;;ACvC3C,gC;;;;;;ACAA,kC;;;;;;ACAA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,OAAO;AACnB,aAAY,OAAO,UAAU;AAC7B,aAAY,OAAO;AACnB;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACvDA;;AAEA;AACA;AACA;;;;;;;ACJA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,kBAAiB,gBAAgB;AACjC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"electron.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap c170c4c28701a1725bed\n **/","declare var require: any\ndeclare var process: any\ndeclare var __dirname: any\n\nconst { app, BrowserWindow } = require ( 'electron' )\nimport { start as startFileStorageSync } from '../modules/FileStorage/helper/FileStorageMain'\n\n// Keep a global reference of the window object, if you don't, the window will\n// be closed automatically when the JavaScript object is garbage collected.\nlet win\n\nfunction createWindow() {\n  // Create the browser window.\n  win = new BrowserWindow({width: 800, height: 600})\n\n  // Here __dirname will be app/build/electron.js\n  win.loadURL(`file://${__dirname}/../electron.dev.html`)\n\n  // Open the DevTools.\n  win.webContents.openDevTools()\n\n  // Emitted when the window is closed.\n  win.on('closed', () => {\n    // Dereference the window object, usually you would store windows\n    // in an array if your app supports multi windows, this is the time\n    // when you should delete the corresponding element.\n    win = null\n  })\n\n  startFileStorageSync ()\n}\n\n// This method will be called when Electron has finished\n// initialization and is ready to create browser windows.\n// Some APIs can only be used after this event occurs.\napp.on( 'ready', createWindow )\n\n// Quit when all windows are closed.\napp.on('window-all-closed', () => {\n  // On macOS it is common for applications and their menu bar\n  // to stay active until the user quits explicitly with Cmd + Q\n  if (process.platform !== 'darwin') {\n    app.quit()\n  }\n})\n\napp.on('activate', () => {\n  // On macOS it's common to re-create a window in the app when the\n  // dock icon is clicked and there are no other windows open.\n  if (win === null) {\n    createWindow()\n  }\n})\n\n\n\n/** WEBPACK FOOTER **\n ** ./boot/electron.ts\n **/","module.exports = require(\"electron\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"electron\"\n ** module id = 1\n ** module chunks = 0\n **/","// FileStorageHelper runs on the window process.\n// This helper runs on the main process.\nimport { ProjectType } from '../../Project/ProjectType'\nimport { SceneType } from '../../Scene/SceneType'\nimport { exportDoc } from '../../Graph/helper/GraphParser'\n\ndeclare var require: any\nconst { ipcMain, dialog } = require ( 'electron' )\nconst fs = require ( 'fs' )\nconst path = require ( 'path' )\nconst sanitize = require ( 'sanitize-filename' )\n\ninterface FileCache {\n  [ key: string ]: string | boolean\n}\n\ninterface SceneCache {\n  scene: SceneType\n  files: FileCache\n}\n\ninterface SceneCaches {\n  [ key: string ]: SceneCache\n}\n\nconst sceneCacheById: SceneCaches = {}\nlet readCache: FileCache\nlet writeCache: FileCache\n\n// Latest project and scene saved to fs\nconst projectCache = { json: '', name: '' }\n\n// User selected project and library paths\n// FIXME !!! \"open project\" and \"select library\" (where is default lib path ?)\nlet projectPath = '/Users/gaspard/git/lucidity.project'\nlet libraryPath = '/Users/gaspard/git/lucidity.library/components'\n\nexport const start = () => {\n\n  ipcMain.on ( 'select-project', () => {\n    // TODO\n    // Must select a \".lucy\" file\n    // and reply with 'selected-directory'\n    // selectedProjectPath ( path )\n  })\n\n  ipcMain.on ( 'select-directory', () => {\n    // TODO\n    // This is used when someone creates a new project\n    // Must select a folder and reply with 'selected-directory'\n    // selectedProjectPath ( path )\n  })\n\n  ipcMain.on\n  ( 'project-changed'\n  , ( event, project: ProjectType ) => {\n      // project graph\n      try {\n        updateGraph\n        ( [ projectPath ]\n        , project\n        , sceneCacheById [ project._id ]\n        )\n      }\n      catch ( err ) {\n        event.sender.send ( 'error', err.message )\n      }\n    }\n  )\n\n  ipcMain.on\n  ( 'scene-changed'\n  , ( event, scene: SceneType ) => {\n      // scenes\n      try {\n        updateGraph\n        ( [ projectPath, 'scenes' ]\n        , scene\n        , sceneCacheById [ scene._id ]\n        )\n      }\n      catch ( err ) {\n        event.sender.send ( 'error', err.message )\n      }\n    }\n  )\n\n  ipcMain.on ( 'save-component', ( event, component ) => {\n    // Save component to library\n  })\n\n  /* TODO: optimize with:\n  ipcMain.on ( 'source-changed', ( event, { blockId, source } ) => {\n\n  })\n  */\n}\n\nconst stat =\n( path: string ): any => {\n  try {\n    return fs.statSync ( path )\n  }\n  catch ( err ) {\n    return null\n  }\n}\n\nconst updateGraph =\n( paths: string[]\n, scene: SceneType | ProjectType\n, cache: SceneCache\n) => {\n  // prepare path\n  writeCache = {}\n  let basepath = paths [ 0 ]\n  for ( let i = 1; i < paths.length; ++i ) {\n    basepath = makeFolder ( basepath, paths [ i ] )\n  }\n\n  if ( !cache ) {\n    const cache: SceneCache = { scene, files: {} }\n    readCache = cache.files\n    writeCache = cache.files\n    createGraph ( basepath, scene )\n    sceneCacheById [ scene._id ] = cache\n  }\n  else {\n    const oscene = cache.scene\n    if ( oscene.name !== scene.name ) {\n      // rename: move folder\n      const from = path.resolve ( basepath, sanitize ( oscene.name ) )\n      const to = path.resolve ( basepath, sanitize ( scene.name ) )\n      const sfrom = stat ( from )\n      const sto = stat ( to )\n      if ( sfrom && sfrom.isDirectory () && !sto ) {\n        // move\n        fs.renameSync ( from, to )\n        console.log ( '[rename] ' + from + ' --> ' + to )\n        // update cache\n        const oldCache = cache.files\n        const newCache = {}\n        const froml = from.length\n        for ( const p in oldCache ) {\n          const np = path.resolve ( to, p.substr ( froml ) )\n          newCache [ np ] = oldCache [ p ]\n        }\n        cache.files = newCache\n      }\n    }\n\n    readCache = cache.files\n    writeCache = {}\n    createGraph ( basepath, scene )\n\n    // we must remove unused files.\n    // longest paths first\n    const keys = Object.keys ( readCache ).sort ( ( a, b ) => a < b ? 1 : -1 )\n    for ( const p of keys ) {\n      if ( ! writeCache [ p ] ) {\n        // remove old file\n        const s = stat ( p )\n        if ( !s ) {\n          // noop\n        } else if ( s.isFile () ) {\n          fs.unlinkSync ( p )\n          console.log ( '[remove] ' + p )\n        } else if ( s.isDirectory () ) {\n          // only remove empty folders that we created\n          const files = fs.readdirSync ( p )\n          if ( files.length === 0 ) {\n            fs.rmdirSync ( p )\n          }\n        }\n        else {\n          // error. FIXME: ignore ?\n        }\n      }\n    }\n    cache.scene = scene\n    cache.files = writeCache\n  }\n}\n\nconst saveFile =\n( base: string, name: string, source: string /*, uuid */ ): void => {\n  const p = path.resolve ( base, sanitize ( name ) )\n  const c = readCache [ p ]\n  // TODO: optimize to use small uuid as third argument to detect block change\n  if ( c === source ) {\n    // not changed\n    writeCache [ p ] = source\n    return\n  }\n  const s = stat ( p )\n  if ( !s || s.isFile () ) {\n    // changed file\n    fs.writeFileSync ( p, source, 'utf8' )\n    console.log ( '[write ] ' + p )\n  }\n  else {\n    // not a file\n    throw `Cannot save graph source to '${p}' (not a file).`\n  }\n  writeCache [ p ] = source\n}\n\nconst makeFolder =\n( base: string, name: string ): string => {\n  const p = path.resolve ( base, sanitize ( name ) )\n  const s = stat ( p )\n  if ( !s ) {\n    fs.mkdirSync ( p )\n    console.log ( '[mkdir ] ' + p )\n  }\n  else if ( !s.isDirectory () ) {\n    // error\n    throw `Cannot save graph to '${p}' (not a folder).`\n  }\n  writeCache [ p ] = true\n  return p\n}\n\nconst createGraph =\n( basepath: string\n, scene: SceneType\n) => {\n  const base = makeFolder ( basepath, scene.name )\n  exportDoc ( scene, base, saveFile, makeFolder )\n}\n\nconst selectedProjectPath =\n( path: string ) => {\n  projectPath = path\n  // clear cache\n  // push scenes into db with importDoc ==> doc\n  // push project content into db\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./modules/FileStorage/helper/FileStorageMain.ts\n **/","import { GraphType, rootNodeId } from '../types'\nimport { SceneType } from '../../Scene'\n\ninterface FileExport {\n  ( folderHelper: any, name: string, source: string ): void\n}\n\ninterface FolderExport {\n  ( folderHelper: any, name: string ): any\n}\n\nconst exportOne =\n( graph: GraphType\n, context: any\n, file: FileExport\n, folder: FolderExport\n, nodeId: string\n, slotref?: string\n) => {\n  const node = graph.nodesById [ nodeId ]\n  const block = graph.blocksById [ node.blockId ]\n  const name = slotref ? `${slotref} ${block.name}` : block.name\n  file ( context, `${name}.ts`, block.source )\n  let sub\n  const children = node.children\n  for ( let i = 0; i < children.length; ++i ) {\n    const slotref = i < 10 ? `0${i}` : String ( i )\n    const childId = children [ i ]\n    if ( childId ) {\n      if ( !sub ) {\n        // create folder for children\n        sub = folder ( context, name )\n      }\n      exportOne ( graph, sub, file, folder, childId, slotref )\n    }\n  }\n}\n\nexport const exportGraph =\n( graph: GraphType\n, context: any // this is the context passed for root element\n, file: FileExport\n, folder: FolderExport\n) => {\n  exportOne ( graph, context, file, folder, rootNodeId )\n}\n\nexport const exportDoc =\n( scene: SceneType\n, context: any\n, file: FileExport\n, folder: FolderExport\n) => {\n  exportOne ( scene.graph, context, file, folder, rootNodeId )\n  saveSettings ( scene, context, file, folder )\n}\n\nconst saveSettings =\n( scene: SceneType\n, context: any\n, file: FileExport\n, folder: FolderExport\n) => {\n  const doc = Object.assign ( {}, scene )\n  delete doc.graph\n  const json = JSON.stringify ( doc, null, 2 )\n  file ( context, 'index.lucy', json )\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./modules/Graph/helper/GraphParser.ts\n **/","export * from './GetTextSizeType'\nexport * from './GraphType'\nexport * from './NodeType'\nexport * from './UIGraphType'\nexport * from './UILayoutType'\nexport * from './UINodeType'\n\n\n\n/** WEBPACK FOOTER **\n ** ./modules/Graph/types/index.ts\n **/","export interface NodeByIdType {\n  [ id: string ]: NodeType\n}\n\nexport interface NodeType {\n  id: string         // node id\n  blockId: string    // _id of the related block\n\n  parent?: string    // node id of the parent (null for root)\n  children: string[] // node ids of children\n\n  //// UI\n  closed?: boolean // children not shown\n\n  //// Computed\n  // When a node is invalid, it is not initialized nor updated.\n  invalid?: boolean\n\n  // Slot connection errors (also renders the node invalid)\n  serr?: string[]\n  // Context errors\n  cerr?: string[]\n  // compiled children if the node has typed information for them. This can be different from children if the node steals from its descendants.\n  childrenm?: string[]\n  // all 'isvoid' children accessible. Only set if this block has\n  // meta.all set to true\n  all?: string[]\n}\n\nexport const nextNodeId =\n( nodesById: NodeByIdType\n) : string => {\n  let n : number = 0\n  while ( nodesById [ `n${n}` ] ) {\n    n += 1\n  }\n  return `n${n}`\n}\n\nexport const rootNodeId = nextNodeId ( {} )\n\n\n\n/** WEBPACK FOOTER **\n ** ./modules/Graph/types/NodeType.ts\n **/","module.exports = require(\"fs\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"fs\"\n ** module id = 6\n ** module chunks = 0\n **/","module.exports = require(\"path\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"path\"\n ** module id = 7\n ** module chunks = 0\n **/","/*jshint node:true*/\n'use strict';\n\n/**\n * Replaces characters in strings that are illegal/unsafe for filenames.\n * Unsafe characters are either removed or replaced by a substitute set\n * in the optional `options` object.\n *\n * Illegal Characters on Various Operating Systems\n * / ? < > \\ : * | \"\n * https://kb.acronis.com/content/39790\n *\n * Unicode Control codes\n * C0 0x00-0x1f & C1 (0x80-0x9f)\n * http://en.wikipedia.org/wiki/C0_and_C1_control_codes\n *\n * Reserved filenames on Unix-based systems (\".\", \"..\")\n * Reserved filenames in Windows (\"CON\", \"PRN\", \"AUX\", \"NUL\", \"COM1\",\n * \"COM2\", \"COM3\", \"COM4\", \"COM5\", \"COM6\", \"COM7\", \"COM8\", \"COM9\",\n * \"LPT1\", \"LPT2\", \"LPT3\", \"LPT4\", \"LPT5\", \"LPT6\", \"LPT7\", \"LPT8\", and\n * \"LPT9\") case-insesitively and with or without filename extensions.\n *\n * Capped at 255 characters in length.\n * http://unix.stackexchange.com/questions/32795/what-is-the-maximum-allowed-filename-and-folder-size-with-ecryptfs\n *\n * @param  {String} input   Original filename\n * @param  {Object} options {replacement: String}\n * @return {String}         Sanitized filename\n */\n\nvar truncate = require(\"truncate-utf8-bytes\");\n\nvar illegalRe = /[\\/\\?<>\\\\:\\*\\|\":]/g;\nvar controlRe = /[\\x00-\\x1f\\x80-\\x9f]/g;\nvar reservedRe = /^\\.+$/;\nvar windowsReservedRe = /^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\\..*)?$/i;\nvar windowsTrailingRe = /[\\. ]+$/;\n\nfunction sanitize(input, replacement) {\n  var sanitized = input\n    .replace(illegalRe, replacement)\n    .replace(controlRe, replacement)\n    .replace(reservedRe, replacement)\n    .replace(windowsReservedRe, replacement)\n    .replace(windowsTrailingRe, replacement);\n  return truncate(sanitized, 255);\n}\n\nmodule.exports = function (input, options) {\n  var replacement = (options && options.replacement) || '';\n  var output = sanitize(input, replacement);\n  if (replacement === '') {\n    return output;\n  }\n  return sanitize(output, '');\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/sanitize-filename/index.js\n ** module id = 8\n ** module chunks = 0\n **/","'use strict';\n\nvar truncate = require(\"./lib/truncate\");\nvar getLength = Buffer.byteLength.bind(Buffer);\nmodule.exports = truncate.bind(null, getLength);\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/truncate-utf8-bytes/index.js\n ** module id = 9\n ** module chunks = 0\n **/","'use strict';\n\nfunction isHighSurrogate(codePoint) {\n  return codePoint >= 0xd800 && codePoint <= 0xdbff;\n}\n\nfunction isLowSurrogate(codePoint) {\n  return codePoint >= 0xdc00 && codePoint <= 0xdfff;\n}\n\n// Truncate string by size in bytes\nmodule.exports = function truncate(getLength, string, byteLength) {\n  if (typeof string !== \"string\") {\n    throw new Error(\"Input must be string\");\n  }\n\n  var charLength = string.length;\n  var curByteLength = 0;\n  var codePoint;\n  var segment;\n\n  for (var i = 0; i < charLength; i += 1) {\n    codePoint = string.charCodeAt(i);\n    segment = string[i];\n\n    if (isHighSurrogate(codePoint) && isLowSurrogate(string.charCodeAt(i + 1))) {\n      i += 1;\n      segment += string[i];\n    }\n\n    curByteLength += getLength(segment);\n\n    if (curByteLength === byteLength) {\n      return string.slice(0, i + 1);\n    }\n    else if (curByteLength > byteLength) {\n      return string.slice(0, i - segment.length + 1);\n    }\n  }\n\n  return string;\n};\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/truncate-utf8-bytes/lib/truncate.js\n ** module id = 10\n ** module chunks = 0\n **/"],"sourceRoot":""}